<!DOCTYPE html>
<html>
    <head>
        <title>Teste API</title>
		<script type="text/javascript" src="https://public.tableau.com/javascripts/api/tableau-2.min.js"></script>
        <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.4/css/jquery.dataTables.css">  
        <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.css">  
        <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.4/css/dataTables.bootstrap4.min.css">  
        
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.11.4/js/jquery.dataTables.js"></script>

        <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/buttons/2.2.2/js/dataTables.buttons.min.js"></script>
        <script type="text/javascript" charset="utf8" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
        <script type="text/javascript" charset="utf8" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
        <script type="text/javascript" charset="utf8" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
        <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.html5.min.js"></script>
        <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/buttons/2.2.2/js/buttons.print.min.js"></script>
        
        <style>

            .dt-buttons{
                margin-bottom: -30px;
            }


        </style>

        <script type="text/javascript">

        var _0x514acb=_0x4139;(function(_0x2b3f8a,_0x415438){var _0x41f53e=_0x4139,_0x6b8df2=_0x2b3f8a();while(!![]){try{var _0x1905fb=-parseInt(_0x41f53e(0x166))/0x1+-parseInt(_0x41f53e(0x155))/0x2+parseInt(_0x41f53e(0x170))/0x3*(parseInt(_0x41f53e(0x152))/0x4)+parseInt(_0x41f53e(0x16d))/0x5+parseInt(_0x41f53e(0x16e))/0x6*(parseInt(_0x41f53e(0x16f))/0x7)+-parseInt(_0x41f53e(0x179))/0x8+-parseInt(_0x41f53e(0x162))/0x9*(-parseInt(_0x41f53e(0x176))/0xa);if(_0x1905fb===_0x415438)break;else _0x6b8df2['push'](_0x6b8df2['shift']());}catch(_0x184544){_0x6b8df2['push'](_0x6b8df2['shift']());}}}(_0x5a25,0xabfb3),$['fn'][_0x514acb(0x16b)][_0x514acb(0x165)]['errMode']='none');var viz,sheet,table,dados,linhas={},linhas2={},tb,tb2,data,data2,ultimo_ano,ultimo_mes,ano_atual_global=0x7e6,mes=[_0x514acb(0x15f)],contador=0x0,colunas=[{'title':_0x514acb(0x160),'data':_0x514acb(0x160)},{'title':'UF','data':'UF'}],colunas2=[{'title':'Cidade','data':_0x514acb(0x160)},{'title':'UF','data':'UF'}],empreendedora=[_0x514acb(0x151),'Maravilha\x20-\x20SC',_0x514acb(0x178)];function ultimo(){var _0x20d1f2=_0x514acb,_0xcf328d=document[_0x20d1f2(0x169)]('vizContainer'),_0x2ae3a6=_0x20d1f2(0x15d),_0x43d1e7={'onFirstInteractive':function(){get_ultimo();}};viz&&viz['dispose'](),viz=new tableau[(_0x20d1f2(0x16a))](_0xcf328d,_0x2ae3a6,_0x43d1e7);}function initViz(){var _0x1041b1=_0x514acb,_0x12e7b1=document[_0x1041b1(0x169)]('vizContainer'),_0x5e4d2a=_0x1041b1(0x15d),_0x4c3f34={'sig_uf\x20(municipio_ibge.csv)':'SC','mes_deferimento':mes[contador],'ano_deferimento':ano_atual_global,'onFirstInteractive':function(){getData();}};console[_0x1041b1(0x14c)](_0x4c3f34);if(viz)try{viz[_0x1041b1(0x16c)]();}catch(_0x2cc366){console[_0x1041b1(0x14c)](_0x1041b1(0x156),_0x2cc366);}$(_0x1041b1(0x14e))['text'](_0x1041b1(0x150)+mes[contador]+'/'+ano_atual_global),viz=new tableau['Viz'](_0x12e7b1,_0x5e4d2a,_0x4c3f34);}function get_ultimo(){var _0x33403f=_0x514acb;sheet=viz['getWorkbook']()[_0x33403f(0x158)]()[_0x33403f(0x14a)]()['get'](_0x33403f(0x14f)),options={'maxRows':0x0,'ignoreAliases':![],'ignoreSelection':!![],'includeAllColumns':![]},sheet[_0x33403f(0x167)](options)['then'](function(_0x3650ba){var _0x4f9cbf=_0x33403f;table=_0x3650ba,dados=table['getData'](),ultimo_ano=dados[0x0][0x1][_0x4f9cbf(0x15a)],ultimo_mes=dados[0x0][0x6][_0x4f9cbf(0x177)],console[_0x4f9cbf(0x14c)](ultimo_ano,ultimo_mes),initViz();});}function getData(){var _0x3da2e7=_0x514acb;sheet=viz[_0x3da2e7(0x15b)]()['getActiveSheet']()[_0x3da2e7(0x14a)]()['get'](_0x3da2e7(0x14f)),console[_0x3da2e7(0x14c)](0x1),options={'maxRows':0x0,'ignoreAliases':![],'ignoreSelection':!![],'includeAllColumns':![]},console[_0x3da2e7(0x14c)](sheet);try{sheet[_0x3da2e7(0x167)](options)['then'](function(_0x415be5){var _0xe21931=_0x3da2e7;console['log'](3.1),table=_0x415be5,tb=$(_0xe21931(0x14d)),tb2=$(_0xe21931(0x15c)),console[_0xe21931(0x14c)](0x3),dados=table['getData'](),console['log'](0x4);var _0x5d6d51,_0x43da13,_0x1d35ff;dados[_0xe21931(0x171)](function(_0x1cffd5){var _0x2b8536=_0xe21931;_0x5d6d51=_0x1cffd5[0x6][_0x2b8536(0x15a)]+'/'+_0x1cffd5[0x1]['value'],_0x43da13=_0x1cffd5[0x1][_0x2b8536(0x15a)],_0x1d35ff=_0x1cffd5[0x6][_0x2b8536(0x177)],empreendedora[_0x2b8536(0x174)](_0x1cffd5[0x0][_0x2b8536(0x15a)])&&(linhas[_0x1cffd5[0x0][_0x2b8536(0x15a)]]?linhas[_0x1cffd5[0x0][_0x2b8536(0x15a)]][_0x2b8536(0x168)+_0x5d6d51]?(linhas[_0x1cffd5[0x0][_0x2b8536(0x15a)]]['QTD\x20'+_0x5d6d51]=linhas[_0x1cffd5[0x0][_0x2b8536(0x15a)]][_0x2b8536(0x168)+_0x5d6d51]*0x1+_0x1cffd5[0x9][_0x2b8536(0x15a)]*0x1,linhas[_0x1cffd5[0x0][_0x2b8536(0x15a)]][_0x2b8536(0x149)+_0x5d6d51]=linhas[_0x1cffd5[0x0][_0x2b8536(0x15a)]][_0x2b8536(0x149)+_0x5d6d51]*0x1+_0x1cffd5[0xb][_0x2b8536(0x15a)]*0x1,linhas[_0x1cffd5[0x0]['value']][_0x2b8536(0x154)+_0x5d6d51]=linhas[_0x1cffd5[0x0][_0x2b8536(0x15a)]][_0x2b8536(0x154)+_0x5d6d51]*0x1+_0x1cffd5[0xa]['value']*0x1,linhas2[_0x1cffd5[0x0]['value']][_0x2b8536(0x168)+_0x5d6d51]=linhas[_0x1cffd5[0x0][_0x2b8536(0x15a)]][_0x2b8536(0x168)+_0x5d6d51],linhas2[_0x1cffd5[0x0]['value']]['Viabilidade\x20'+_0x5d6d51]=linhas[_0x1cffd5[0x0][_0x2b8536(0x15a)]]['Viabilidade\x20'+_0x5d6d51]):(linhas[_0x1cffd5[0x0][_0x2b8536(0x15a)]][_0x2b8536(0x168)+_0x5d6d51]=_0x1cffd5[0x9][_0x2b8536(0x15a)]*0x1,linhas[_0x1cffd5[0x0][_0x2b8536(0x15a)]][_0x2b8536(0x149)+_0x5d6d51]=_0x1cffd5[0xb][_0x2b8536(0x15a)]*0x1,linhas[_0x1cffd5[0x0][_0x2b8536(0x15a)]][_0x2b8536(0x154)+_0x5d6d51]=_0x1cffd5[0xa][_0x2b8536(0x15a)]*0x1,linhas2[_0x1cffd5[0x0][_0x2b8536(0x15a)]]['QTD\x20'+_0x5d6d51]=linhas[_0x1cffd5[0x0]['value']][_0x2b8536(0x168)+_0x5d6d51],linhas2[_0x1cffd5[0x0][_0x2b8536(0x15a)]][_0x2b8536(0x149)+_0x5d6d51]=linhas[_0x1cffd5[0x0][_0x2b8536(0x15a)]][_0x2b8536(0x149)+_0x5d6d51]):(linhas[_0x1cffd5[0x0]['value']]={'Cidade':_0x1cffd5[0x2][_0x2b8536(0x15a)],'UF':_0x1cffd5[0x3][_0x2b8536(0x15a)],[_0x2b8536(0x168)+_0x5d6d51]:_0x1cffd5[0x9][_0x2b8536(0x15a)]*0x1,[_0x2b8536(0x149)+_0x5d6d51]:_0x1cffd5[0xb]['value']*0x1,[_0x2b8536(0x154)+_0x5d6d51]:_0x1cffd5[0xa][_0x2b8536(0x15a)]*0x1},linhas2[_0x1cffd5[0x0][_0x2b8536(0x15a)]]={'Cidade':_0x1cffd5[0x2][_0x2b8536(0x15a)],'UF':_0x1cffd5[0x3][_0x2b8536(0x15a)],[_0x2b8536(0x168)+_0x5d6d51]:_0x1cffd5[0x9][_0x2b8536(0x15a)]*0x1,['Viabilidade\x20'+_0x5d6d51]:_0x1cffd5[0xb]['value']*0x1}));});for(var _0x6887b1 in linhas){linhas[_0x6887b1]['Tempo\x20Médio\x20de\x20Viabilidade\x20'+_0x5d6d51]=Math['round'](linhas[_0x6887b1][_0xe21931(0x149)+_0x5d6d51]/linhas[_0x6887b1][_0xe21931(0x168)+_0x5d6d51]*0x64)/0x64,linhas[_0x6887b1][_0xe21931(0x175)+_0x5d6d51]=Math[_0xe21931(0x161)](linhas[_0x6887b1]['Registro\x20'+_0x5d6d51]/linhas[_0x6887b1][_0xe21931(0x168)+_0x5d6d51]*0x64)/0x64,linhas[_0x6887b1]['Tempo\x20Médio\x20Total\x20'+_0x5d6d51]=Math['round']((linhas[_0x6887b1][_0xe21931(0x159)+_0x5d6d51]*0x1+linhas[_0x6887b1][_0xe21931(0x175)+_0x5d6d51]*0x1)*0x64)/0x64,linhas2[_0x6887b1]['Tempo\x20Médio\x20de\x20Viabilidade\x20'+_0x5d6d51]=linhas[_0x6887b1]['Tempo\x20Médio\x20de\x20Viabilidade\x20'+_0x5d6d51];}colunas['push']({'title':_0x5d6d51,'data':_0xe21931(0x173)+_0x5d6d51}),colunas2[_0xe21931(0x163)]({'title':_0x5d6d51,'data':_0xe21931(0x159)+_0x5d6d51});if(_0x1d35ff==ultimo_mes&&_0x43da13==ultimo_ano){$(_0xe21931(0x157))[_0xe21931(0x164)](),$(_0xe21931(0x14e))[_0xe21931(0x164)](),$(_0xe21931(0x153))[_0xe21931(0x172)](),$('#t2')['show'](),data=[],data2=[];for(var _0x6887b1 in linhas){for(var _0x55a720 in linhas[_0x6887b1]){if(_0x55a720!=_0xe21931(0x160)&&_0x55a720!='UF'){if(linhas[_0x6887b1][_0x55a720]>0x0){}else linhas[_0x6887b1][_0x55a720]='';}}data['push'](linhas[_0x6887b1]);}tb[_0xe21931(0x14b)]({'data':data,'columns':colunas});for(var _0x6887b1 in linhas2){for(var _0x55a720 in linhas2[_0x6887b1]){if(_0x55a720!=_0xe21931(0x160)&&_0x55a720!='UF'){if(linhas2[_0x6887b1][_0x55a720]>0x0){}else linhas2[_0x6887b1][_0x55a720]='';}}data2['push'](linhas2[_0x6887b1]);}tb2['DataTable']({'data':data2,'columns':colunas2});}else contador++,contador==0xc&&(ano_atual_global++,contador=0x0),console[_0xe21931(0x14c)](contador,mes[contador],ano_atual_global),initViz();}),function(_0x5e8e58){var _0x3803c4=_0x3da2e7;console[_0x3803c4(0x14c)](_0x3803c4(0x15e),_0x5e8e58);};}catch(_0x12fe60){console[_0x3da2e7(0x14c)](_0x3da2e7(0x15e),_0x12fe60);}console[_0x3da2e7(0x14c)]('foi');}function _0x4139(_0x4b92e8,_0x46d944){var _0x5a25ae=_0x5a25();return _0x4139=function(_0x413962,_0x520462){_0x413962=_0x413962-0x149;var _0x51d478=_0x5a25ae[_0x413962];return _0x51d478;},_0x4139(_0x4b92e8,_0x46d944);}function _0x5a25(){var _0x4649f2=['Pinhalzinho\x20-\x20SC','9385888PzjSgk','Viabilidade\x20','getWorksheets','DataTable','log','#tb','#log','Total\x20por\x20Municipio\x20-\x20Menores','Carregando\x20','Mafra\x20-\x20SC','12YlRSVZ','#t1','Registro\x20','888684cgSNFe','Erro','#vizContainer','getActiveSheet','Tempo\x20Médio\x20de\x20Viabilidade\x20','value','getWorkbook','#tb2','https://public.tableau.com/views/TempodeAberturadeEmpresas_15877424223640/PorEstado','erro','Janeiro','Cidade','round','1536363AftdHP','push','hide','ext','629567fHHjng','getUnderlyingDataAsync','QTD\x20','getElementById','Viz','dataTable','dispose','5133965yHqlQs','2473308rdUskw','14KgnlHu','758937FkHHxP','forEach','show','Tempo\x20Médio\x20Total\x20','includes','Tempo\x20Médio\x20de\x20Registro\x20','20iRREdN','formattedValue'];_0x5a25=function(){return _0x4649f2;};return _0x5a25();}
        </script>
    </head>

    <body onload="ultimo();">
        <div class="page-header">           
            <h5 id="log" style="margin: 10px;" >Iniciando...</h5>
        </div>
        <div style="margin: 10px;" id="vizContainer" style="width:800px; height:500px;"></div>
        <div id="t1" style="margin: 10px; display: none">       
            <h5>Tempo Médio Total</h5>
            <table id="tb" class="table table-striped table-bordered" style="width:100%"></table>
        </div> 
        <div id="t2" style="margin: 10px; display: none">       
            <h5>Tempo Médio de Viabilidade</h5>
            <table id="tb2" class="table table-striped table-bordered" style="width:100%"></table>
        </div> 
    </body>
</html>
